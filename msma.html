<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Forever & Always</title>
  <meta name="description" content="Minimal black love page with fade-in message, typed line + heartbeat, and hidden YouTube chorus." />
  <style>
    :root{ --bg:#000; --fg:#f5f5f5; --accent:red; --muted:#cfcfcf }
    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0; background:var(--bg); color:var(--fg);
      display:grid; place-items:center;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      padding:24px;
    }
    main{ width:min(860px,95vw); text-align:center; line-height:1.65 }

    .ucapan{ font-size:clamp(14px,2.4vw,18px); text-align:justify; opacity:0; transition:opacity 1.2s ease }
    .ucapan.show{ opacity:1 }

    .love{ margin-top:22px; font-size:clamp(18px,3vw,24px) }

    .heartbeat{ display:inline-block; color:var(--accent); font-size:1.4em; animation:beat 2.2s infinite; transform-origin:center }
    @keyframes beat{ 0%,100%{transform:scale(1)} 30%{transform:scale(1.18)} 60%{transform:scale(1)} 80%{transform:scale(1.18)} }

    .sig{ margin-top:10px; color:var(--muted); font-style:italic; font-size:clamp(14px,2.4vw,18px); opacity:0; transition:opacity .6s ease }
    .sig.show{ opacity:1 }

    .caret{ display:inline-block; width:.6ch; height:1em; translate:0 .15em; background:var(--fg); animation:blink 1s step-end infinite }
    @keyframes blink{ 50%{opacity:0} }

    /* Hidden (but playable) YouTube area */
    #yt-holder{
      position:fixed; left:-9999px; top:auto; width:1px; height:1px; opacity:0;
      pointer-events:none;
    }

    /* Fallback overlay when autoplay is blocked */
    #overlay{
      position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.6);
      backdrop-filter: blur(2px);
    }
    #overlay .card{
      border:1px solid #333; padding:18px 22px; border-radius:10px; text-align:center;
      background:#0a0a0a;
    }
    #overlay button{
      margin-top:12px; padding:10px 16px; border-radius:8px; border:1px solid #444; background:#111; color:#fff;
      cursor:pointer;
    }
    #unmuteBtn{
      position:fixed; right:14px; bottom:14px;
      padding:8px 12px; border-radius:999px; border:1px solid #444; background:#111; color:#fff;
      font-size:14px; display:none; cursor:pointer; opacity:.9;
    }
  </style>
</head>
<body>
  <main>
    <div id="ucapan" class="ucapan">
To my sayang hensem, MSMA<br>
Thanks for being always sabar for me & terima mek in your life. Sikda lain yang mek boleh padah, mek bena bena sayangkan ktk. Thank you for evrything and kmk minta maaf dari sudut hati mek paling dalam untuk semua salah silap mek ke sayang selama kita kenal dan in future kelak. Mek minta maaf sik sempurna untuk syg, dan harap syg bersabar dengan mek. Mek hargai semua yang syg beri ke kmk dari segi kasih syg, caring, ilmu, nasihat, teguran dan semua benda yang syg pernah bagi even sekecik particles. Semua ya dah cukup dan sempurna sbg bukti yg ktk syg kmk. Kmk truly hargai semua ya, semua usaha syg dan sentiasa ingat semua moment kita. Terima kasih untuk semua dan selalu ada untuk kmk. Kmk sentiasa doakan kebahagiaan syg, rasa mek ke syg tetap sama dan sentiasa syg. even kita ok or sik okay sperti mek padah ke syg selalu, i love you always & forever. Jaga diri, jaga hati, jaga kesihatan & jaga mata utk mek. Mek mok syg utamakan diri syg juak & syg diri syg juak cuz mek love you so much & rindu syg setiap detik. Apa pun jadi, mek sentiasa ada untuk syg sentiasa & bila-bila.
    </div>

    <div id="love" class="love"></div>
    <p id="sig" class="sig">‚Äî From your sayang comel, ZP üòùüòò ‚Äî</p>
  </main>

  <!-- Hidden YouTube container (use IFrame API for reliable autoplay on localhost) -->
  <div id="yt-holder"><div id="player"></div></div>
  <div id="overlay" role="dialog" aria-modal="true">
    <div class="card">
      <div>Tap to play the chorus üéß</div>
      <button id="playNow">Play now</button>
    </div>
  </div>
  <button id="unmuteBtn" aria-label="Unmute">üîä Unmute</button>

  <script>
    // ===== Text effects =====
    function sleep(ms){ return new Promise(r=>setTimeout(r, ms)); }
    setTimeout(()=>{ document.getElementById('ucapan').classList.add('show'); }, 500);

    async function typeLove(){
      const el = document.getElementById('love');
      const text = 'I love you ‚Äî forever & always ';
      const caret = document.createElement('span'); caret.className='caret';
      el.textContent='';
      for(const ch of text){
        caret.remove(); el.textContent += ch; el.appendChild(caret);
        await sleep(28 + Math.random()*22);
      }
      caret.remove();
      const heart = document.createElement('span');
      heart.className='heartbeat'; heart.textContent='‚ù§';
      el.appendChild(heart);
      await sleep(600);
      document.getElementById('sig').classList.add('show');
    }
    setTimeout(typeLove, 3000);

    // ====== YouTube IFrame API autoplay (muted) with graceful fallback ======
    // Load API
    const tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    document.head.appendChild(tag);

    let player, attemptedPlay = false;
    const OVERLAY = document.getElementById('overlay');
    const UNMUTE = document.getElementById('unmuteBtn');

    function showOverlay(){ OVERLAY.style.display = 'grid'; }
    function hideOverlay(){ OVERLAY.style.display = 'none'; }

    // YT API callback
    window.onYouTubeIframeAPIReady = function(){
      player = new YT.Player('player', {
        videoId: 'ie-mXf5Lon8', // chorus source
        playerVars: {
          autoplay: 1, controls: 0, start: 45, rel: 0, modestbranding: 1,
          playsinline: 1, // iOS inline
          enablejsapi: 1
        },
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange
        }
      });
    };

    function onPlayerReady(){
      try {
        player.mute(); // start muted for autoplay policy
        player.playVideo();
        attemptedPlay = true;
        // Offer unmute button
        UNMUTE.style.display = 'inline-block';
        // Try to unmute after small delay (may be ignored by policy)
        setTimeout(()=>{ try{ player.unMute(); }catch{} }, 1200);
      } catch(e){
        // If anything fails, show overlay to request a tap
        showOverlay();
      }
    }

    function onPlayerStateChange(e){
      // If playback paused/ended unexpectedly and we didn't interact yet, show overlay
      if ((e.data === YT.PlayerState.UNSTARTED || e.data === YT.PlayerState.PAUSED) && !attemptedPlay){
        showOverlay();
      }
    }

    // Overlay click -> play with sound
    document.getElementById('playNow').addEventListener('click', ()=>{
      hideOverlay();
      try{
        player.unMute();
        player.playVideo();
        UNMUTE.style.display = 'inline-block';
      }catch{}
    });

    // Floating unmute button
    UNMUTE.addEventListener('click', ()=>{
      try{
        if(player.isMuted()) player.unMute(); else player.mute();
        UNMUTE.textContent = player.isMuted() ? 'üîä Unmute' : 'üîà Mute';
      }catch{}
    });
  </script>
</body>
</html>
